(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{873:function(t,e,n){"use strict";function r(data){return"[object Array]"===Object.prototype.toString.call(data)}function o(t,e){if(!t)throw new Error(e)}function c(data){return Object.keys(data)}function l(data){return Object.keys(data).map((function(t){return[t,data[t]]}))}function d(t,e,n){var r="."+e,o=new RegExp("(\\".concat(e,")?$"));return n(t).replace(o,r)}function f(content,t,e,n){void 0===e&&(e="download"),void 0===n&&(n=!0);var r=function(content,t,e){switch(t){case"txt":var n="text/plain;charset=utf-8";return e?URL.createObjectURL(new Blob([content],{type:n})):"data:,".concat(n)+encodeURIComponent(content);case"css":return n="text/css;charset=utf-8",e?URL.createObjectURL(new Blob([content],{type:n})):"data:,".concat(n)+encodeURIComponent(content);case"html":return n="text/html;charset=utf-8",e?URL.createObjectURL(new Blob([content],{type:n})):"data:,".concat(n)+encodeURIComponent(content);case"json":return n="text/json;charset=utf-8",e?URL.createObjectURL(new Blob([content],{type:n})):"data:,".concat(n)+encodeURIComponent(content);case"csv":return n="text/csv;charset=utf-8",e?URL.createObjectURL(new Blob([content],{type:n})):"data:,".concat(n)+encodeURIComponent(content);case"xls":return n="text/application/vnd.ms-excel;charset=utf-8",e?URL.createObjectURL(new Blob([content],{type:n})):"data:,".concat(n)+encodeURIComponent(content);case"xml":return n="text/application/xml;charset=utf-8",e?URL.createObjectURL(new Blob([content],{type:n})):"data:,".concat(n)+encodeURIComponent(content);default:return""}}(content,t,n),o=document.createElement("a");o.href=r,o.download=e,o.setAttribute("style","visibility:hidden"),document.body.appendChild(o),o.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!1,view:window})),document.body.removeChild(o)}var h=function(){return h=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},h.apply(this,arguments)},v=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),c=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c};function m(data){return data.map(l).reduce((function(t,e,n){return e.reduce((function(map,t){var e=v(t,2),r=e[0],o=e[1],c=map[r]||Array.from({length:data.length}).map((function(t){return""}));return c[n]=("string"!=typeof o?JSON.stringify(o):o)||"",map[r]=c,map}),t)}),Object.create(null))}function x(t,e){return void 0===e&&(e=function(i){return i}),e(l(t).map((function(t){var e=v(t,2);return{fieldName:e[0],fieldValues:e[1]}})))}function y(t){var e=/,|"|\n/.test(t)?'"':"",n=t.replace(/"/g,'""');return"".concat(e).concat(n).concat(e)}function w(data,t){if(void 0===t&&(t=function(i){return i}),!data.length)return"";var content='<html>\n  <head>\n    <meta charset="UTF-8" />\n  </head >\n  <body>\n    '.concat(function(data,t){o(data.length>0);var e=x(m(data),t),head=e.map((function(t){return t.fieldName})).join("</b></th><th><b>"),n=e.map((function(t){return t.fieldValues})).map((function(t){return t.map((function(t){return"<td>".concat(t,"</td>")}))})).reduce((function(t,e){return t.map((function(t,n){return"".concat(t).concat(e[n])}))}));return"\n    <table>\n      <thead>\n        <tr><th><b>".concat(head,"</b></th></tr>\n      </thead>\n      <tbody>\n        <tr>").concat(n.join("</tr>\n        <tr>"),"</tr>\n      </tbody>\n    </table>\n  ")}(data,t),"\n  </body>\n</html >\n");return content}function O(data){return'<?xml version="1.0" encoding="utf-8"?><!DOCTYPE base>\n'.concat(C(data,"base"),"\n")}function C(data,t,e,n){void 0===e&&(e="element"),void 0===n&&(n=0);var o,c=(o=t,"555xmlHello .  world!".trim().replace(/^([0-9,;]|(xml))+/,""),o.replace(/[^_a-zA-Z 0-9:\-\.]/g,"").replace(/^([ 0-9-:\-\.]|(xml))+/i,"").replace(/ +/g,"-")),d=function(t){return Array(t+1).join(" ")}(n);if(null==data)return"".concat(d,"<").concat(c," />");var content=r(data)?data.map((function(t){return C(t,e,e,n+2)})).join("\n"):"object"==typeof data?l(data).map((function(t){var r=v(t,2),o=r[0];return C(r[1],o,e,n+2)})).join("\n"):d+"  "+String(data).replace(/([<>&])/g,(function(t,e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return""}}));return"".concat(d,"<").concat(c,">\n").concat(content,"\n").concat(d,"</").concat(c,">")}function j(t){var data=t.data,e=t.fileName,n=void 0===e?"download":e,C=t.extension,j=t.fileNameFormatter,R=void 0===j?function(t){return t.replace(/\s+/,"_")}:j,U=t.fields,T=t.exportType,_=void 0===T?"txt":T,N=t.replacer,D=void 0===N?null:N,E=t.space,I=void 0===E?4:E,S=t.processor,L=void 0===S?f:S,A=t.withBOM,B=void 0!==A&&A,F=t.beforeTableEncode,k=void 0===F?function(i){return i}:F,$="Invalid export data. Please provide an array of objects",J="Can't export unknown data type ".concat(_,"."),M="Can't export string data to ".concat(_,".");if("string"==typeof data)switch(_){case"txt":case"css":case"html":return L(data,_,d(n,null!=C?C:_,R));default:throw new Error(M)}var z=function(t){if(!t||r(t)&&!t.length||!r(t)&&!c(t).length)return function(t){return t};var e=r(t)?t.reduce((function(map,t){var e;return h(h({},map),((e={})[t]=t,e))}),Object.create(null)):t;return function(t){return r(t)?t.map((function(i){return l(i).reduce((function(map,t){var n=v(t,2),r=n[0],o=n[1];return r in e&&(map[e[r]]=o),map}),Object.create(null))})).filter((function(i){return c(i).length})):l(t).reduce((function(map,t){var n=v(t,2),r=n[0],o=n[1];return r in e&&(map[e[r]]=o),map}),Object.create(null))}}(U),P=z(function(data){try{return"string"==typeof data?JSON.parse(data):data}catch(t){throw new Error("Invalid export data. Please provide a valid JSON")}}(data)),V=function(data,t,e){void 0===t&&(t=null);try{return JSON.stringify(data,t,e)}catch(t){throw new Error("Invalid export data. Please provide valid JSON object")}}(P,D,I);switch(_){case"txt":case"css":case"html":return L(V,_,d(n,null!=C?C:_,R));case"json":return L(V,_,d(n,null!=C?C:"json",R));case"csv":o(r(P),$);var H=function(data,t){if(void 0===t&&(t=function(i){return i}),!data.length)return"";var e=x(m(data),t);return e.map((function(t){return t.fieldName})).join(",")+"\r\n"+e.map((function(t){return t.fieldValues})).map((function(t){return t.map(y)})).reduce((function(t,e){return t.map((function(t,n){return"".concat(t,",").concat(e[n])}))})).join("\r\n")}(P,k);return L(B?"\ufeff"+H:H,_,d(n,null!=C?C:"csv",R));case"xls":return o(r(P),$),L(w(P,k),_,d(n,null!=C?C:"xls",R));case"xml":return L(O(P),_,d(n,null!=C?C:"xml",R));default:throw new Error(J)}}j.types={txt:"txt",css:"css",html:"html",json:"json",csv:"csv",xls:"xls",xml:"xml"},j.processors={downloadFile:f};var R=j;e.a=R},949:function(t,e,n){"use strict";n.r(e);n(19),n(371),n(45),n(8),n(26);var r=n(63),o=n(873),c={name:"rtnumberchart",props:["config"],data:function(){return{receivedTime:0,value:0,time:Date.now(),nowTime:Date.now(),isMounted:!1,topic:"",chartOptions:{credits:{enabled:!1},chart:{renderTo:"container",defaultSeriesType:"line",backgroundColor:"rgba(0,0,0,0)"},title:{text:""},xAxis:{type:"datetime",labels:{style:{color:"#d4d2d2"}}},yAxis:{title:{text:""},labels:{style:{color:"#d4d2d2",font:"11px Trebuchet MS, Verdana, sans-serif"}}},plotOptions:{series:{label:{connectorAllowed:!1},pointStart:2010}},series:[{name:"",data:[],color:"#e14eca"}],legend:{itemStyle:{color:"#d4d2d2"}},responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{layout:"horizontal",align:"center",verticalAlign:"bottom"}}}]}}}},watch:{config:{immediate:!0,deep:!0,handler:function(){var t=this;setTimeout((function(){t.value=0,t.$nuxt.$off(t.topic+"/sdata"),t.topic=t.config.userId+"/"+t.config.selectedDevice.dId+"/"+t.config.variable,t.$nuxt.$on(t.topic+"/sdata",t.procesReceivedData),t.chartOptions.series[0].data=[],t.getChartData(),t.chartOptions.series[0].name=t.config.variableFullName+" "+t.config.unit,t.updateColorClass(),window.dispatchEvent(new Event("resize"))}),300)}}},mounted:function(){this.getNow(),this.updateColorClass()},beforeDestroy:function(){this.$nuxt.$off(this.topic+"/sdata")},methods:{updateColorClass:function(){console.log("update"+this.config.class);var t=this.config.class;"success"==t&&(this.chartOptions.series[0].color="#00f2c3"),"primary"==t&&(this.chartOptions.series[0].color="#e14eca"),"warning"==t&&(this.chartOptions.series[0].color="#ff8d72"),"danger"==t&&(this.chartOptions.series[0].color="#fd5d93"),this.chartOptions.series[0].name=this.config.variableFullName+" "+this.config.unit},getChartData:function(){var t=this;if(this.config.demo)return this.chartOptions.series[0].data=this.config.information,void(this.isMounted=!0);var e={headers:{token:$nuxt.$store.state.auth.token},params:{dId:this.config.selectedDevice.dId,variable:this.config.variable,chartTimeAgo:this.config.chartTimeAgo}};this.$axios.get("/get-small-charts-data",e).then((function(e){t.chartOptions.series[0].data=[];var data=e.data.data;console.log(e.data),data.forEach((function(element){var e=[];e.push(element.time+60*(new Date).getTimezoneOffset()*1e3*-1),e.push(element.value),t.chartOptions.series[0].data.push(e)})),t.isMounted=!0})).catch((function(t){console.log(t)}))},getIconColorClass:function(){return"success"==this.config.class?"text-success":"primary"==this.config.class?"text-primary":"warning"==this.config.class?"text-warning":"danger"==this.config.class?"text-danger":void 0},procesReceivedData:function(data){var t=this;try{this.time=Date.now(),this.value=data.value,setTimeout((function(){1==data.save&&t.getChartData()}),1e3)}catch(t){console.log(t)}},getNow:function(){var t=this;this.nowTime=Date.now(),setTimeout((function(){t.getNow()}),1e3)},getTimeAgo:function(t){return t<0&&(t=0),t<59?t.toFixed()+" secs":t>59&&t<=3600?(t/=60).toFixed()+" min":t>3600&&t<=86400?(t/=3600).toFixed()+" hour":t>86400?(t/=86400).toFixed()+" day":void 0},descargarExcel:function(){var data=this.config.information,t=o.a.types.csv;Object(o.a)({data:data,fileName:"download",exportType:t})}},components:{BaseButton:r.default}},l=n(2),component=Object(l.a)(c,(function(){var t=this,e=t._self._c;return e("card",{attrs:{type:"chart"}},[e("template",{slot:"header"},[e("h5",{staticClass:"card-category pull-right"},[t._v("\n      "+t._s(t.getTimeAgo((t.nowTime-t.time)/1e3))+" ago\n    ")]),t._v(" "),e("h5",{staticClass:"card-category"},[t._v("\n      "+t._s(t.config.selectedDevice.name)+" - "+t._s(t.config.variableFullName)+"\n    ")]),t._v(" "),e("h3",{staticClass:"card-title"},[e("i",{staticClass:"fa",class:[t.config.icon,t.getIconColorClass()],staticStyle:{"font-size":"30px"},attrs:{"aria-hidden":"true"}}),t._v(" "),e("span",[t._v(t._s(t.value.toFixed(t.config.decimalPlaces))+" "+t._s(t.config.unit))])])]),t._v(" "),e("div",{staticClass:"chart-area",staticStyle:{height:"300px"}},[t.isMounted?e("highchart",{staticStyle:{height:"100%"},attrs:{options:t.chartOptions}}):t._e()],1),t._v(" "),e("div",{staticClass:"row pull-right"},[e("div",{staticClass:"col-12"},[e("base-button",{staticClass:"mb-3",attrs:{type:"blue",size:"lg"},on:{click:function(e){return t.descargarExcel()}}},[t._v("Descargar reporte")])],1)])],2)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{BaseButton:n(63).default,Card:n(51).default})}}]);